---
import Container from "../ui/Container.astro";
import Badge from "../ui/Badge.astro";
import Button from "../ui/Button.astro";
import { products } from "../../data/products";

interface Props {
  id: string;
  title: string;
  description: string;
  lang: "es" | "en";
}

const { id, title, description, lang } = Astro.props;
---

<section id={id} class="products-section">
  <!-- Subtle tech background -->
  <div class="section-bg-overlay"></div>

  <Container>
    <div class="section-header">
      <h2 class="section-title">{title}</h2>
      <p class="section-desc">{description}</p>
    </div>

    <div class="products-list">
      {
        products.map((product) => (
          <div class="product-card">
            <div
              class="product-thumb"
              style={`background: ${product.gradient}`}
            >
              <div class="thumb-overlay" />
              {/* Removed Badges Overlay */}
            </div>

            <div class="product-info">
              <div class="info-content">
                <h3 class="product-title">{product.title[lang]}</h3>
                <p class="product-desc">{product.description[lang]}</p>

                <ul class="product-features">
                  {product.features[lang].map((feature) => (
                    <li>
                      <svg
                        class="check-icon"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="3"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <polyline points="20 6 9 17 4 12" />
                      </svg>
                      <span>{feature}</span>
                    </li>
                  ))}
                </ul>
              </div>

              <div class="product-actions">
                <Button
                  href={product.href[lang]}
                  target={product.target}
                  variant="glow"
                  class="w-full"
                >
                  {lang === "es" ? "Explorar Soluci√≥n" : "Explore Solution"}
                </Button>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </Container>
</section>

<style>
  .products-section {
    position: relative;
    padding: var(--space-32) 0 var(--space-40); /* Massive increase for separation */
    background-color: var(--bg);
    overflow: hidden;
  }

  .section-bg-overlay {
    position: absolute;
    inset: 0;
    background-image: radial-gradient(var(--border) 1px, transparent 1px);
    background-size: 48px 48px;
    opacity: 0.25;
    pointer-events: none;
  }

  :global([data-theme="light"]) .products-section {
    background-color: #fcfcfd;
  }

  .section-header {
    position: relative;
    z-index: 20; /* Fixed: Higher than cards to prevent overlap on hover */
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--space-20);
  }

  .section-title {
    font-size: clamp(2rem, 4vw, 2.75rem);
    font-weight: 800;
    line-height: 1.1;
    margin-bottom: var(--space-4);
    color: var(--text);
    letter-spacing: -0.02em;
  }

  :global([data-theme="light"]) .section-title {
    color: var(--text);
  }

  .section-desc {
    color: var(--text-muted);
    font-size: var(--text-lg);
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
  }

  /* Grid Layout: Horizontal List (Side-by-Side) */
  .products-list {
    position: relative;
    z-index: 10;
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-8);
    max-width: 1200px;
    margin: 0 auto;
  }

  @media (min-width: 1024px) {
    .products-list {
      grid-template-columns: repeat(2, 1fr); /* 2 Columns on Desktop */
      gap: var(--space-12);
    }
  }

  /* Vertical Pro Card for Grid */
  .product-card {
    position: relative;
    display: flex;
    flex-direction: column;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 24px;
    overflow: hidden;
    transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
    height: 500px; /* Increased another 10% (from 460px) */
    max-width: 600px; /* Increased another 10% (from 550px) */
    margin: 0 auto;
  }

  :global([data-theme="dark"]) .product-card {
    background: rgba(15, 23, 42, 0.4);
    backdrop-filter: blur(24px);
    border-color: rgba(255, 255, 255, 0.1);
  }

  :global([data-theme="light"]) .product-card {
    background: #fff;
    border-color: rgba(0, 0, 0, 0.05);
  }

  .product-card:hover {
    transform: translateY(-12px) scale(1.02);
    box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.2);
    border-color: var(--primary);
  }

  .product-thumb {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #0f172a;
    z-index: 0;
  }

  .thumb-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 1s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .product-card:hover .thumb-img {
    transform: scale(1.1);
  }

  .thumb-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.9) 0%,
      rgba(0, 0, 0, 0.4) 50%,
      rgba(0, 0, 0, 0.2) 100%
    );
    z-index: 1;
  }

  .badges-overlay {
    position: absolute;
    top: var(--space-6);
    left: var(--space-6);
    display: flex;
    gap: var(--space-2);
    z-index: 2;
  }

  .compact-badge {
    padding: 6px 16px;
    font-size: 11px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 99px;
  }

  .product-info {
    position: relative;
    z-index: 2;
    padding: var(--space-8);
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end; /* Text at bottom */
    background: transparent;
    color: white;
  }

  @media (min-width: 1024px) {
    .product-info {
      padding: var(--space-10);
    }
  }

  .product-title {
    font-size: var(--text-2xl);
    font-weight: 800;
    margin-bottom: var(--space-2);
    letter-spacing: -0.03em;
    color: white;
    line-height: 1.2;
  }

  .product-desc {
    color: rgba(255, 255, 255, 0.8);
    font-size: var(--text-sm);
    line-height: 1.6;
    margin-bottom: var(--space-6);
    font-weight: 400;
  }

  .product-features {
    list-style: none;
    padding: 0;
    margin: 0 0 var(--space-6) 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .product-features li {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--text-xs);
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
  }

  .check-icon {
    color: var(--primary);
    flex-shrink: 0;
    background: rgba(var(--primary-rgb), 0.1);
    width: 24px;
    height: 24px;
    padding: 4px;
    border-radius: 6px;
  }

  .product-actions {
    margin-top: auto;
  }

  .w-full {
    width: 100%;
  }
</style>
